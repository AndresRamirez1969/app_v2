import{_ as pe,ar as fe,J as O,A as ve,B as f,an as be,aC as ge,am as Q,c as d,s as r,w as t,a as o,b as m,l as p,f as U,aj as h,C as b,t as u,Q as Z,G as K,p as $,m as A,e as v,u as V,H as W,x as X,V as k,d as l,a9 as j,ao as Y,q as me,v as ee,a6 as _e,aB as ye,Z as he,o as i,a0 as te,O as D}from"./index-BtdFDd_C.js";import{j as ke,k as se,l as le,p as oe,f as xe,e as we}from"./mdi-CCqP_oQm.js";import{_ as G}from"./StatusChip-DyVs1_p3.js";const Ce={key:1,class:"font-weight-medium ml-3 mb-0 d-none d-md-block"},Ne={key:2,class:"font-weight-medium ml-3 mb-0 d-block d-md-none"},Ve={key:1},ze={key:0},$e={key:1},Ae={key:1},De={key:1},Se=["onClick"],Be={class:"folio-cell"},Ee={class:"logo-cell"},Ie=["src"],Le={class:"legal-cell"},Te={class:"address-cell"},Ue={class:"status-cell"},je={key:1},Ge={key:0},Me={class:"d-md-none"},Re={class:"logo-container-mobile"},Fe=["src"],He={class:"d-flex align-center mb-1",style:{"justify-content":"space-between"}},Pe={class:"text-caption",style:{"margin-right":"8px"}},qe={class:"font-weight-medium mb-1"},Je={class:"text-caption"},Oe={key:1},Qe={__name:"show",setup(Ze){const S=he(),ae=ge(),{mdAndDown:ne}=fe(),a=O(null),x=O([]),ie=ve(),B=f(()=>ie.user||{roles:[],permissions:[],organization_id:null}),E=f(()=>B.value.roles||[]),z=f(()=>B.value.permissions||[]),I=f(()=>E.value.includes("superadmin")),M=f(()=>E.value.includes("admin")),ue=f(()=>E.value.includes("sponsor")),R=f(()=>z.value.includes("businessUnitGroup.view")),de=f(()=>z.value.includes("businessUnitGroup.viewAny")),L=f(()=>z.value.includes("businessUnitGroup.update")),T=f(()=>I.value||M.value||ue.value),w=f(()=>{var s,e;return((s=a.value)==null?void 0:s.status)==="activa"||((e=a.value)==null?void 0:e.status)==="active"}),re=s=>s?I.value||M.value?!0:z.value.includes("business.view")?s.business&&s.business.organization_id===B.value.organization_id:!1:!1,F=()=>{var s;(s=a.value)!=null&&s.id&&S.push({path:`/grupos-de-ubicaciones/editar/${a.value.id}`})},ce=()=>{S.push("/grupos-de-ubicaciones")},H=s=>S.push({path:`/ubicaciones/${s.id}`}),P=s=>{if(!s)return"No disponible";if(typeof s=="string")return s;s.address&&typeof s.address=="object"&&(s=s.address);const e=s.street||s.calle||"",_=s.outdoor_number||s.numero_exterior||s.num_ext||"",n=s.neighborhood||s.colonia||"",g=s.city||s.ciudad||"",y=s.postal_code||s.cp||s.codigo_postal||"",C=s.state||s.estado||"",N=s.country||s.pais||"";let c=[];return e&&c.push(e),_&&c.push(_),n&&c.push(n),g&&c.push(g),y&&c.push(y),C&&c.push(C),N&&c.push(N),c.length?c.join(", "):"No disponible"},q=(s,e=80)=>s?s.length>e?s.slice(0,e)+"...":s:"",J=async()=>{if(!a.value)return;const s=w.value?"inactive":"active";try{const e=await Q.put(`/business-unit-groups/${a.value.id}`,{status:s});a.value.status=e.data.status||s}catch{alert("No se pudo cambiar el estatus")}};return be(async()=>{if(R.value)try{const s=ae.params.id,e=await Q.get(`/business-unit-groups/${s}`);a.value=e.data||e.data.group||e.data.data,x.value=a.value.business_units||a.value.businessUnits||[]}catch(s){console.error("Error al obtener el grupo o las ubicaciones:",s)}}),(s,e)=>{const _=me("router-link");return R.value?(i(),d(_e,{key:0,fluid:""},{default:t(()=>[o(k,{class:"align-center mb-6","no-gutters":""},{default:t(()=>[o(m,{cols:"auto",class:"d-flex align-center"},{default:t(()=>[de.value?(i(),d(U,{key:0,icon:"",variant:"text",class:"px-3 py-2",style:{"border-radius":"8px",border:"1px solid #ccc","min-width":"44px",height:"44px"},onClick:ce},{default:t(()=>[o(h,{icon:b(ke)},null,8,["icon"])]),_:1})):p("",!0),a.value?(i(),r("h3",Ce,u(a.value.id?`${a.value.id}`:"")+" "+u(a.value.name?`- ${a.value.name}`:"- Grupo"),1)):p("",!0),a.value?(i(),r("h3",Ne,u(a.value.id?`${a.value.id}`:""),1)):p("",!0)]),_:1}),o(m,{class:"d-flex justify-end align-center"},{default:t(()=>[L.value||T.value?(i(),r(V,{key:0},[b(ne)?(i(),d(Z,{key:1,location:"bottom end"},{activator:t(({props:n})=>[o(U,X(n,{icon:"",variant:"text",class:"pa-0","min-width":"0",height:"44",style:{"border-radius":"8px",border:"1px solid #ccc","min-width":"44px"}}),{default:t(()=>[o(h,{icon:b(we),size:"24"},null,8,["icon"])]),_:2},1040)]),default:t(()=>[o(K,{class:"custom-dropdown elevation-1 rounded-lg",style:{"min-width":"180px"}},{default:t(()=>[L.value?(i(),d($,{key:0,onClick:F},{prepend:t(()=>[o(h,{icon:b(se),size:"16"},null,8,["icon"])]),default:t(()=>[o(A,null,{default:t(()=>e[4]||(e[4]=[v("Editar")])),_:1})]),_:1})):p("",!0),T.value?(i(),r(V,{key:1},[o(W,{class:"my-1"}),o($,{onClick:J},{prepend:t(()=>[o(h,{icon:w.value?b(le):b(oe),size:"16"},null,8,["icon"])]),default:t(()=>[o(A,null,{default:t(()=>[v(u(w.value?"Desactivar":"Activar"),1)]),_:1})]),_:1})],64)):p("",!0)]),_:1})]),_:1})):(i(),d(Z,{key:0,location:"bottom end"},{activator:t(({props:n})=>[o(U,X(n,{variant:"text",class:"px-3 py-2",style:{"border-radius":"8px",border:"1px solid #ccc","min-width":"44px",height:"44px"}}),{default:t(()=>[e[2]||(e[2]=v(" Opciones ")),o(h,{icon:b(xe),end:"",size:"18"},null,8,["icon"])]),_:2},1040)]),default:t(()=>[o(K,{class:"custom-dropdown elevation-1 rounded-lg",style:{"min-width":"200px"}},{default:t(()=>[L.value?(i(),d($,{key:0,onClick:F},{prepend:t(()=>[o(h,{icon:b(se),size:"16"},null,8,["icon"])]),default:t(()=>[o(A,null,{default:t(()=>e[3]||(e[3]=[v("Editar")])),_:1})]),_:1})):p("",!0),T.value?(i(),r(V,{key:1},[o(W,{class:"my-1"}),o($,{onClick:J},{prepend:t(()=>[o(h,{icon:w.value?b(le):b(oe),size:"16"},null,8,["icon"])]),default:t(()=>[o(A,null,{default:t(()=>[v(u(w.value?"Desactivar":"Activar"),1)]),_:1})]),_:1})],64)):p("",!0)]),_:1})]),_:1}))],64)):p("",!0)]),_:1})]),_:1}),o(k,null,{default:t(()=>[o(m,{cols:"12",class:"mb-2"},{default:t(()=>e[5]||(e[5]=[l("div",{class:"font-weight-bold text-h6"},"Información General",-1)])),_:1})]),_:1}),o(k,null,{default:t(()=>[o(m,{cols:"12"},{default:t(()=>[o(j,{class:"rounded-lg pa-4 mb-6 elevation-1 info-card-effect"},{default:t(()=>[o(Y,{class:"rounded-lg elevation-0",style:{border:"none"}},{default:t(()=>{var n,g,y,C,N,c;return[l("tbody",null,[l("tr",null,[e[6]||(e[6]=l("td",{class:"font-weight-bold text-subtitle-1",style:{width:"40%"}},"Estatus",-1)),l("td",null,[(n=a.value)!=null&&n.status?(i(),d(G,{key:0,status:(g=a.value)==null?void 0:g.status},null,8,["status"])):(i(),r("span",Ve,"No disponible"))])]),l("tr",null,[e[7]||(e[7]=l("td",{class:"font-weight-bold text-subtitle-1"},"ID",-1)),l("td",null,u(((y=a.value)==null?void 0:y.id)??"No disponible"),1)]),l("tr",null,[e[8]||(e[8]=l("td",{class:"font-weight-bold text-subtitle-1"},"Nombre",-1)),l("td",null,u(((C=a.value)==null?void 0:C.name)??"No disponible"),1)]),I.value?(i(),r("tr",ze,[e[9]||(e[9]=l("td",{class:"font-weight-bold text-subtitle-1"},"Organización",-1)),l("td",null,[(N=a.value)!=null&&N.organization?(i(),d(_,{key:0,to:`/organizaciones/${a.value.organization.id}`,class:"blue-link"},{default:t(()=>[v(u(a.value.organization.folio)+" - "+u(a.value.organization.legal_name),1)]),_:1},8,["to"])):(i(),r("span",$e,"No disponible"))])])):p("",!0),a.value&&re(a.value)?(i(),r("tr",Ae,[e[10]||(e[10]=l("td",{class:"font-weight-bold text-subtitle-1"},"Empresa",-1)),l("td",null,[(c=a.value)!=null&&c.business?(i(),d(_,{key:0,to:`/empresas/${a.value.business.id}`,class:"blue-link"},{default:t(()=>[v(u(a.value.business.folio)+" - "+u(a.value.business.legal_name),1)]),_:1},8,["to"])):(i(),r("span",De,"No disponible"))])])):p("",!0)])]}),_:1})]),_:1})]),_:1})]),_:1}),o(k,null,{default:t(()=>[o(m,{cols:"12",class:"mb-2"},{default:t(()=>e[11]||(e[11]=[l("div",{class:"font-weight-bold text-h6"},"Ubicaciones vinculadas",-1)])),_:1})]),_:1}),o(k,null,{default:t(()=>[o(m,{cols:"12"},{default:t(()=>[o(Y,{class:"rounded-lg elevation-1 fixed-table d-none d-md-table",style:{width:"100%"}},{default:t(()=>[e[15]||(e[15]=l("thead",null,[l("tr",null,[l("th",{class:"folio-header font-weight-bold text-subtitle-1"},"Folio"),l("th",{class:"logo-header font-weight-bold text-subtitle-1"},"Logo"),l("th",{class:"legal-header font-weight-bold text-subtitle-1"},"Nombre"),l("th",{class:"address-header font-weight-bold text-subtitle-1"},"Dirección"),l("th",{style:{width:"15%"}}),l("th",{class:"status-header font-weight-bold text-subtitle-1"},"Estatus")])],-1)),l("tbody",null,[(i(!0),r(V,null,ee(x.value,(n,g)=>(i(),r("tr",{key:n.id||g,class:"row-clickable",onClick:y=>H(n),style:{cursor:"pointer"}},[l("td",Be,[o(_,{to:`/ubicaciones/${n.id}`,class:"blue-link",onClick:e[0]||(e[0]=te(()=>{},["stop"]))},{default:t(()=>[v(u(n.folio||"No disponible"),1)]),_:2},1032,["to"])]),l("td",Ee,[n.logo?(i(),d(D,{key:0,size:"48",class:"logo-avatar"},{default:t(()=>[l("img",{src:n.logo,alt:"Logo",class:"logo-img-cover"},null,8,Ie)]),_:2},1024)):(i(),d(D,{key:1,size:"48",color:"grey lighten-2",class:"d-flex align-center justify-center"},{default:t(()=>e[12]||(e[12]=[l("span",{style:{"font-size":"12px",color:"#888"}},"Sin logo",-1)])),_:1}))]),l("td",Le,u(n.legal_name||"No disponible"),1),l("td",Te,u(n.address?q(P(n.address),80):"No disponible"),1),e[13]||(e[13]=l("td",null,null,-1)),l("td",Ue,[n.status?(i(),d(G,{key:0,status:n.status},null,8,["status"])):(i(),r("span",je,"No disponible"))])],8,Se))),128)),x.value.length===0?(i(),r("tr",Ge,e[14]||(e[14]=[l("td",{colspan:"6",class:"text-center text-medium-emphasis"},"No hay ubicaciones vinculadas.",-1)]))):p("",!0)])]),_:1}),l("div",Me,[(i(!0),r(V,null,ee(x.value,(n,g)=>(i(),d(j,{key:n.id||g,class:"mb-4 pa-3 elevation-1 rounded-lg row-clickable",onClick:y=>H(n),style:{cursor:"pointer"}},{default:t(()=>[o(k,{"no-gutters":"",align:"center",class:"mb-1"},{default:t(()=>[o(m,{cols:"3",class:"d-flex justify-start align-center"},{default:t(()=>[l("div",Re,[n.logo?(i(),d(D,{key:0,class:"logo-avatar-mobile",color:"grey lighten-2"},{default:t(()=>[l("img",{src:n.logo,alt:"Logo",class:"logo-img-cover"},null,8,Fe)]),_:2},1024)):(i(),d(D,{key:1,class:"logo-avatar-mobile",color:"grey lighten-2"},{default:t(()=>e[16]||(e[16]=[l("span",{style:{"font-size":"12px",color:"#888"}},"Sin logo",-1)])),_:1}))])]),_:2},1024),o(m,{cols:"1"}),o(m,{cols:"8"},{default:t(()=>[l("div",He,[l("div",Pe,[o(_,{to:`/ubicaciones/${n.id}`,class:"blue-link",onClick:e[1]||(e[1]=te(()=>{},["stop"]))},{default:t(()=>[v(u(n.folio),1)]),_:2},1032,["to"])]),o(G,{status:n.status},null,8,["status"])]),l("div",qe,u(n.legal_name),1),l("div",Je,[e[17]||(e[17]=l("strong",null,"Dirección:",-1)),v(" "+u(n.address?q(P(n.address),80):"No disponible"),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),x.value.length===0?(i(),d(j,{key:0,class:"mb-4 pa-4 elevation-1 rounded-lg text-center"},{default:t(()=>e[18]||(e[18]=[l("div",{class:"font-weight-bold mb-2",style:{"font-size":"1.5rem"}},"No hay ubicaciones vinculadas",-1)])),_:1})):p("",!0)])]),_:1})]),_:1})]),_:1})):(i(),r("div",Oe,[o(ye,{type:"error",class:"mt-10",variant:"outlined",density:"comfortable"},{default:t(()=>e[19]||(e[19]=[v(" No tienes acceso a este grupo de ubicaciones. ")])),_:1})]))}}},Ye=pe(Qe,[["__scopeId","data-v-15be7b2e"]]);export{Ye as default};
