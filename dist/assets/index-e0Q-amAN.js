import{s as d,o as l,a,d as u,w as n,l as x,e as b,ae as Z,ao as Be,ap as Ue,_ as Ae,a0 as he,A as me,B as w,J as p,q as _e,u as ee,aq as fe,al as I,v as ge,c as h,a2 as X,t as S,am as ye,ab as ze,N as Se,S as ce,G as Le,p as oe,m as ue,C as P,H as be,f as te,x as ve,L as ie,ar as $e,ai as le,as as Ee,U as re,af as Ie,ag as Pe,at as Oe,b5 as ke,b3 as we,au as De,an as Ne,K as Ge,V as xe,b as de,a8 as Fe}from"./index-mAfd8qbF.js";import{b as Me,k as Te,l as He,p as je,e as Ke,f as qe,g as Re,i as Ce}from"./mdi-CCqP_oQm.js";import{_ as Ve}from"./StatusChip-ejlLwmE5.js";/* empty css                */const Je={class:"d-flex justify-center mt-4"},Qe={__name:"BusinessUnitGroupsTableMeta",props:{items:{type:Array,default:()=>[]},page:Number,itemsPerPage:Number,sortBy:String,sortDesc:Boolean,showOrganization:Boolean,showBusiness:Boolean},emits:["update:page","sort"],setup(O,{emit:F}){const $=O,z=F;return(y,s)=>{var B;return l(),d("div",null,[a(Be,{density:"comfortable",class:"fixed-table elevation-1 rounded-lg"},{default:n(()=>[u("thead",null,[u("tr",null,[u("th",{onClick:s[0]||(s[0]=m=>z("sort","id")),class:"cursor-pointer folio-header"},[s[7]||(s[7]=b(" Identificador ")),Z(y.$slots,"sort-icon",{column:"id"})]),u("th",{onClick:s[1]||(s[1]=m=>z("sort","name")),class:"cursor-pointer legal-header"},[s[8]||(s[8]=b(" Nombre ")),Z(y.$slots,"sort-icon",{column:"name"})]),O.showOrganization?(l(),d("th",{key:0,onClick:s[2]||(s[2]=m=>z("sort","organization")),class:"cursor-pointer organization-header"},[s[9]||(s[9]=b(" OrganizaciÃ³n ")),Z(y.$slots,"sort-icon",{column:"organization"})])):x("",!0),O.showBusiness?(l(),d("th",{key:1,onClick:s[3]||(s[3]=m=>z("sort","business")),class:"cursor-pointer company-header"},[s[10]||(s[10]=b(" Empresa ")),Z(y.$slots,"sort-icon",{column:"business"})])):x("",!0),u("th",{onClick:s[4]||(s[4]=m=>z("sort","business_units_count")),class:"cursor-pointer address-header"},[s[11]||(s[11]=b(" Ubicaciones ")),Z(y.$slots,"sort-icon",{column:"business_units_count"})]),s[12]||(s[12]=u("th",{class:"status-header"},"Estado",-1)),s[13]||(s[13]=u("th",{class:"actions-header"},null,-1))])]),u("tbody",null,[Z(y.$slots,"rows",{showOrganization:O.showOrganization,showBusiness:O.showBusiness})])]),_:3}),u("div",Je,[a(Ue,{modelValue:$.page,"onUpdate:modelValue":[s[5]||(s[5]=m=>$.page=m),s[6]||(s[6]=m=>z("update:page",m))],length:Math.ceil((((B=$.items)==null?void 0:B.length)||1)/$.itemsPerPage),"total-visible":"7",color:"primary"},null,8,["modelValue","length"])])])}}},We={key:0,class:"text-center py-8"},Xe={key:1,class:"text-center py-8"},Ye={class:"d-flex flex-column gap-2"},Ze={class:"d-flex align-center justify-space-between mb-1"},et={class:"text-caption",style:{"margin-right":"8px"}},tt={key:1},st={class:"font-weight-medium mb-1"},nt={key:0,class:"text-caption mb-1"},at={key:1},lt={key:1,class:"text-caption mb-1"},it={key:1},ot={class:"text-caption mb-1"},ut={key:0,class:"text-center py-8"},rt={key:1,class:"text-center py-8"},dt=["onClick"],ct={key:1},vt={key:0},mt={key:1},pt={key:1},ft={key:1},gt={__name:"BusinessUnitGroupsList",props:{items:Array,isMobile:Boolean,canEditPermission:Boolean,isLoading:Boolean},setup(O){const F=O,$=he(),z=me(),y=w(()=>z.user||{roles:[],permissions:[],organization_id:null}),s=w(()=>y.value.roles||[]),B=w(()=>y.value.permissions||[]),m=w(()=>s.value.includes("superadmin")),_=w(()=>s.value.includes("admin")),j=o=>m.value||_.value?!0:B.value.includes("business.view")?o.business&&o.business.organization_id===y.value.organization_id:!1,M=w(()=>m.value||_.value?!0:B.value.includes("business.view")?F.items.some(o=>o.business&&o.business.organization_id===y.value.organization_id):!1),L=w(()=>m.value||_.value||s.value.includes("sponsor")),K=w(()=>B.value.includes("businessUnitGroup.update")||F.canEditPermission),U=w(()=>B.value.includes("businessUnitGroup.view")),q=w(()=>U.value||K.value||L.value),E=p("id"),C=p(!1),f=p(1),k=p(10),R=o=>{E.value===o?C.value=!C.value:(E.value=o,C.value=!1)},A=o=>o.organization?{text:`${o.organization.folio} - ${o.organization.legal_name}`,id:o.organization.id}:null,V=o=>o.business?{text:`${o.business.folio} - ${o.business.legal_name}`,id:o.business.id}:null,T=w(()=>[...F.items].sort((o,t)=>{var N,v,Q,G,W,ne,ae,c,e,i,Y,pe;let g,r;return E.value==="business_units_count"?(g=o.business_units_count??((N=o.businessUnits)==null?void 0:N.length)??0,r=t.business_units_count??((v=t.businessUnits)==null?void 0:v.length)??0,(g-r)*(C.value?-1:1)):E.value==="organization"?(g=((G=(Q=A(o))==null?void 0:Q.text)==null?void 0:G.toLowerCase())??"",r=((ne=(W=A(t))==null?void 0:W.text)==null?void 0:ne.toLowerCase())??"",g.localeCompare(r)*(C.value?-1:1)):E.value==="business"?(g=((c=(ae=V(o))==null?void 0:ae.text)==null?void 0:c.toLowerCase())??"",r=((i=(e=V(t))==null?void 0:e.text)==null?void 0:i.toLowerCase())??"",g.localeCompare(r)*(C.value?-1:1)):(g=((Y=o[E.value])==null?void 0:Y.toString().toLowerCase())??"",r=((pe=t[E.value])==null?void 0:pe.toString().toLowerCase())??"",g.localeCompare(r)*(C.value?-1:1))})),D=w(()=>{const o=(f.value-1)*k.value;return T.value.slice(o,o+k.value)}),J=o=>$.push({path:`/grupos-de-ubicaciones/editar/${o.id}`}),H=o=>$.push({path:`/grupos-de-ubicaciones/${o.id}`}),se=async o=>{if(!L.value)return;const g=o.status==="activa"||o.status==="active"?"inactive":"active";try{const r=await ie.put(`/business-unit-groups/${o.id}`,{status:g});o.status=r.data.status||g}catch{alert("No se pudo cambiar el estatus")}};return(o,t)=>{const g=_e("router-link");return l(),d("div",null,[O.isMobile?(l(),d(ee,{key:0},[O.isLoading?(l(),d("div",We,[a(fe,{indeterminate:"",color:"primary",size:"64"}),t[8]||(t[8]=u("p",{class:"mt-4"},"Cargando grupos...",-1))])):D.value.length?x("",!0):(l(),d("div",Xe,[a(I,{size:"64",color:"grey lighten-1"},{default:n(()=>t[9]||(t[9]=[b("mdi-domain-off")])),_:1}),t[10]||(t[10]=u("p",{class:"mt-4 text-h6 text-grey-darken-1"},"No existen grupos",-1)),t[11]||(t[11]=u("p",{class:"text-body-2 text-grey"},"No se encontraron grupos con los filtros aplicados",-1))])),(l(!0),d(ee,null,ge(D.value,r=>(l(),h(ze,{key:r.id,class:"mb-4 pa-3 elevation-1 rounded-lg row-clickable",onClick:N=>U.value?H(r):void 0,style:ye({cursor:U.value?"pointer":"default"})},{default:n(()=>{var N;return[u("div",Ye,[u("div",Ze,[u("div",et,[U.value?(l(),h(g,{key:0,to:`/grupos-de-ubicaciones/${r.id}`,onClick:t[0]||(t[0]=X(()=>{},["stop"])),style:{"text-decoration":"underline"}},{default:n(()=>[b(S(r.id),1)]),_:2},1032,["to"])):(l(),d("span",tt,S(r.id),1))]),a(Ve,{status:r.status},null,8,["status"])]),u("div",st,S(r.name),1),m.value?(l(),d("div",nt,[t[12]||(t[12]=u("strong",null,"OrganizaciÃ³n:",-1)),A(r)?(l(),h(g,{key:0,to:`/organizaciones/${A(r).id}`,onClick:t[1]||(t[1]=X(()=>{},["stop"])),style:{"text-decoration":"underline"}},{default:n(()=>[b(S(A(r).text),1)]),_:2},1032,["to"])):(l(),d("span",at,"No disponible"))])):x("",!0),j(r)?(l(),d("div",lt,[t[13]||(t[13]=u("strong",null,"Empresa:",-1)),V(r)?(l(),h(g,{key:0,to:`/empresas/${V(r).id}`,onClick:t[2]||(t[2]=X(()=>{},["stop"])),style:{"text-decoration":"underline"}},{default:n(()=>[b(S(V(r).text),1)]),_:2},1032,["to"])):(l(),d("span",it,"No disponible"))])):x("",!0),u("div",ot,[t[14]||(t[14]=u("strong",null,"Ubicaciones:",-1)),b(" "+S(r.business_units_count??((N=r.businessUnits)==null?void 0:N.length)??0),1)])])]}),_:2},1032,["onClick","style"]))),128))],64)):(l(),d(ee,{key:1},[O.isLoading?(l(),d("div",ut,[a(fe,{indeterminate:"",color:"primary",size:"64"}),t[15]||(t[15]=u("p",{class:"mt-4"},"Cargando grupos...",-1))])):D.value.length?(l(),h(Qe,{key:2,items:T.value.value,page:f.value,itemsPerPage:k.value,sortBy:E.value,sortDesc:C.value,showOrganization:m.value,showBusiness:M.value,"onUpdate:page":t[7]||(t[7]=r=>f.value=r),onSort:R},{"sort-icon":n(({column:r})=>[E.value===r?(l(),h(I,{key:0,size:"16",class:"ml-1"},{default:n(()=>[b(S(C.value?P(qe):P(Re)),1)]),_:1})):x("",!0)]),rows:n(({showOrganization:r,showBusiness:N})=>[(l(!0),d(ee,null,ge(D.value,v=>{var Q;return l(),d("tr",{key:v.id,onClick:G=>U.value?H(v):void 0,class:Se(["row-clickable",{"row-disabled":!U.value}]),style:ye({cursor:U.value?"pointer":"default"})},[u("td",null,[U.value?(l(),h(g,{key:0,to:`/grupos-de-ubicaciones/${v.id}`,onClick:t[3]||(t[3]=X(()=>{},["stop"])),class:"blue-link"},{default:n(()=>[b(S(v.id),1)]),_:2},1032,["to"])):(l(),d("span",ct,S(v.id),1))]),u("td",null,S(v.name),1),r?(l(),d("td",vt,[A(v)?(l(),h(g,{key:0,to:`/organizaciones/${A(v).id}`,onClick:t[4]||(t[4]=X(()=>{},["stop"])),class:"blue-link"},{default:n(()=>[b(S(A(v).text),1)]),_:2},1032,["to"])):(l(),d("span",mt,"No disponible"))])):x("",!0),N?(l(),d("td",pt,[V(v)?(l(),h(g,{key:0,to:`/empresas/${V(v).id}`,onClick:t[5]||(t[5]=X(()=>{},["stop"])),class:"blue-link"},{default:n(()=>[b(S(V(v).text),1)]),_:2},1032,["to"])):(l(),d("span",ft,"No disponible"))])):x("",!0),u("td",null,S(v.business_units_count??((Q=v.businessUnits)==null?void 0:Q.length)??0),1),u("td",null,[a(Ve,{status:v.status},null,8,["status"])]),u("td",{class:"actions-cell",onClick:t[6]||(t[6]=X(()=>{},["stop"]))},[q.value?(l(),h(ce,{key:0,location:"bottom end"},{activator:n(({props:G})=>[a(te,ve({ref_for:!0},G,{variant:"text",class:"pa-0","min-width":"0",height:"24"}),{default:n(()=>[a(I,{icon:P(Ke),size:"20"},null,8,["icon"])]),_:2},1040)]),default:n(()=>[a(Le,{class:"custom-dropdown elevation-1 rounded-lg",style:{"min-width":"200px"}},{default:n(()=>[U.value?(l(),h(oe,{key:0,onClick:G=>H(v)},{prepend:n(()=>[a(I,{icon:P(Me),size:"18"},null,8,["icon"])]),default:n(()=>[a(ue,null,{default:n(()=>t[19]||(t[19]=[b("Ver")])),_:1})]),_:2},1032,["onClick"])):x("",!0),K.value&&U.value?(l(),h(be,{key:1,class:"my-1"})):x("",!0),K.value?(l(),h(oe,{key:2,onClick:G=>J(v)},{prepend:n(()=>[a(I,{icon:P(Te),size:"18"},null,8,["icon"])]),default:n(()=>[a(ue,null,{default:n(()=>t[20]||(t[20]=[b("Editar")])),_:1})]),_:2},1032,["onClick"])):x("",!0),L.value?(l(),h(be,{key:3,class:"my-1"})):x("",!0),L.value?(l(),h(oe,{key:4,onClick:G=>se(v)},{prepend:n(()=>[a(I,{icon:v.status==="activa"||v.status==="active"?P(He):P(je),size:"18"},null,8,["icon"])]),default:n(()=>[a(ue,null,{default:n(()=>[b(S(v.status==="activa"||v.status==="active"?"Desactivar":"Activar"),1)]),_:2},1024)]),_:2},1032,["onClick"])):x("",!0)]),_:2},1024)]),_:2},1024)):x("",!0)])],14,dt)}),128))]),_:1},8,["items","page","itemsPerPage","sortBy","sortDesc","showOrganization","showBusiness"])):(l(),d("div",rt,[a(I,{size:"64",color:"grey lighten-1"},{default:n(()=>t[16]||(t[16]=[b("mdi-domain-off")])),_:1}),t[17]||(t[17]=u("p",{class:"mt-4 text-h6 text-grey-darken-1"},"No existen grupos",-1)),t[18]||(t[18]=u("p",{class:"text-body-2 text-grey"},"No se encontraron grupos con los filtros aplicados",-1))]))],64))])}}},yt=Ae(gt,[["__scopeId","data-v-2ffd46d7"]]),bt={class:"d-flex align-center mb-6",style:{gap:"16px"}},kt={class:"filter-btn-wrapper ml-2 flex-shrink-0",style:{"min-width":"44px",position:"relative"}},wt={key:1,class:"filter-btn-content"},xt={key:0,class:"filter-indicator"},Ct={key:0,class:"mb-3"},Vt={key:1,class:"mb-3"},ht={class:"mb-3"},zt={__name:"BusinessUnitGroupsFilters",emits:["search","filter"],setup(O,{emit:F}){const $=F,z=p(""),y=p(!1),s=p(null),B=[{title:"Activo",value:"active"},{title:"Inactivo",value:"inactive"}],m=p(null),_=p(null),j=p(!1),M=p(!1),{mdAndDown:L}=$e(),K=me(),U=w(()=>K.user||{roles:[],permissions:[]}),q=w(()=>U.value.roles||[]),E=w(()=>U.value.permissions||[]),C=w(()=>q.value.includes("superadmin")),f=w(()=>q.value.includes("admin")),k=w(()=>q.value.includes("sponsor")),R=w(()=>E.value.includes("businessUnitGroup.viewAny")),A=w(()=>C.value||f.value||k.value||R.value),V=p(null),T=p([]),D=p(""),J=p(!1),H=async c=>{if(C.value){J.value=!0;try{const{data:e}=await ie.get("/organizations",{params:{q:c||"",limit:10}});T.value=(e.data||[]).map(i=>({...i,display:`${i.folio}${i.legal_name?" - "+i.legal_name:""}`}))}catch{T.value=[]}finally{J.value=!1}}};function se(c,e,i){return e?(c.folio+" "+(c.legal_name||"")).toLowerCase().includes(e.toLowerCase()):!0}const o=p(null),t=p([]),g=p(""),r=p(!1),N=async c=>{if(A.value){r.value=!0;try{const{data:e}=await ie.get("/businesses",{params:{q:c||"",limit:10}});t.value=(e.data||[]).map(i=>({...i,display:`${i.folio}${i.legal_name?" - "+i.legal_name:""}`}))}catch{t.value=[]}finally{r.value=!1}}};function v(c,e,i){return e?(c.folio+" "+(c.legal_name||"")).toLowerCase().includes(e.toLowerCase()):!0}le(y,c=>{c&&C.value&&T.value.length===0&&H(""),c&&A.value&&t.value.length===0&&N("")}),le(D,c=>{C.value&&H(c)}),le(g,c=>{A.value&&N(c)}),le(z,c=>{$("search",c)});const Q=w(()=>!!s.value||!!m.value||!!_.value||!!V.value||!!o.value);function G(){$("search",z.value)}function W(c){return c?typeof c=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(c)?c:new Date(c).toISOString().slice(0,10):null}function ne(){$("filter",{organizationId:V.value,businessId:o.value,status:s.value,createdAtStart:W(m.value),createdAtEnd:W(_.value)}),y.value=!1}function ae(){s.value=null,m.value=null,_.value=null,V.value=null,D.value="",o.value=null,g.value="",$("filter",{organizationId:null,businessId:null,status:null,createdAtStart:null,createdAtEnd:null})}return(c,e)=>(l(),d("div",bt,[a(re,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=i=>z.value=i),placeholder:"Buscar por nombre...","prepend-inner-icon":"mdi-magnify",clearable:"",class:"flex-grow-1 search-bar",density:"compact",variant:"outlined",color:"primary","hide-details":"",style:{"min-width":"220px"},onKeyup:Ee(G,["enter"]),"onClick:clear":G},null,8,["modelValue"]),u("div",kt,[a(te,{icon:P(L),variant:"text",class:"filter-btn filter-btn-center",style:{"border-radius":"8px",border:"1px solid #ccc","min-width":"44px",height:"44px",width:"100%"},color:"#222",onClick:e[1]||(e[1]=i=>y.value=!0)},{default:n(()=>[P(L)?(l(),h(I,{key:0},{default:n(()=>e[17]||(e[17]=[u("svg",{viewBox:"0 0 24 24",width:"22",height:"22"},[u("path",{fill:"currentColor",d:"M3 6h18v2H3V6m3 6h12v2H6v-2m3 6h6v2H9v-2z"})],-1)])),_:1})):(l(),d("span",wt,[a(I,{class:"mr-2"},{default:n(()=>e[18]||(e[18]=[u("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[u("path",{fill:"currentColor",d:"M3 6h18v2H3V6m3 6h12v2H6v-2m3 6h6v2H9v-2z"})],-1)])),_:1}),e[20]||(e[20]=u("span",null,"Filtros",-1)),a(I,{class:"ml-2",end:""},{default:n(()=>e[19]||(e[19]=[b("mdi-filter-variant")])),_:1})]))]),_:1},8,["icon"]),Q.value?(l(),d("span",xt)):x("",!0)]),a(Ne,{modelValue:y.value,"onUpdate:modelValue":e[16]||(e[16]=i=>y.value=i),"max-width":"420"},{default:n(()=>[a(ze,{class:"modal-padding",style:{position:"relative"}},{default:n(()=>[a(te,{icon:"",variant:"text",class:"position-absolute close-btn",style:{top:"10px",right:"10px",color:"#222","z-index":"10"},onClick:e[2]||(e[2]=i=>y.value=!1)},{default:n(()=>[a(I,null,{default:n(()=>e[21]||(e[21]=[u("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[u("path",{fill:"currentColor",d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])),_:1})]),_:1}),a(Ie,{class:"font-weight-bold"},{default:n(()=>e[22]||(e[22]=[b("Filtros avanzados")])),_:1}),a(Pe,{class:"pb-0"},{default:n(()=>[a(Oe,{modelValue:s.value,"onUpdate:modelValue":e[3]||(e[3]=i=>s.value=i),items:B,label:"Estado",clearable:"","hide-details":"",variant:"outlined",color:"primary",class:"mb-3 filter-padding",style:{"padding-top":"0px","padding-bottom":"0px"}},null,8,["modelValue"]),C.value?(l(),d("div",Ct,[a(ke,{modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=i=>V.value=i),items:T.value,loading:J.value,"search-input":D.value,"onUpdate:searchInput":[e[5]||(e[5]=i=>D.value=i),H],"item-title":"display","item-value":"id",label:"Buscar organizaciÃ³n (folio o nombre legal)",clearable:"","hide-details":"",variant:"outlined",color:"primary",density:"compact",filter:se,"menu-props":{maxHeight:"300px"}},null,8,["modelValue","items","loading","search-input"])])):x("",!0),A.value?(l(),d("div",Vt,[a(ke,{modelValue:o.value,"onUpdate:modelValue":e[6]||(e[6]=i=>o.value=i),items:t.value,loading:r.value,"search-input":g.value,"onUpdate:searchInput":[e[7]||(e[7]=i=>g.value=i),N],"item-title":"display","item-value":"id",label:"Buscar empresa (folio o nombre legal)",clearable:"","hide-details":"",variant:"outlined",color:"primary",density:"compact",filter:v,"menu-props":{maxHeight:"300px"}},null,8,["modelValue","items","loading","search-input"])])):x("",!0),u("div",ht,[a(ce,{modelValue:j.value,"onUpdate:modelValue":e[11]||(e[11]=i=>j.value=i),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290","min-width":"auto"},{activator:n(({props:i})=>[a(re,ve({"model-value":W(m.value),label:"Creado desde",readonly:""},i,{clearable:"","hide-details":"",variant:"outlined",color:"primary",class:"filter-padding date-field mb-2","onClick:clear":e[8]||(e[8]=Y=>m.value=null)}),null,16,["model-value"])]),default:n(()=>[a(we,{modelValue:m.value,"onUpdate:modelValue":[e[9]||(e[9]=i=>m.value=i),e[10]||(e[10]=i=>j.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"]),a(ce,{modelValue:M.value,"onUpdate:modelValue":e[15]||(e[15]=i=>M.value=i),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290","min-width":"auto"},{activator:n(({props:i})=>[a(re,ve({"model-value":W(_.value),label:"Creado hasta",readonly:""},i,{clearable:"","hide-details":"",variant:"outlined",color:"primary",class:"filter-padding date-field","onClick:clear":e[12]||(e[12]=Y=>_.value=null)}),null,16,["model-value"])]),default:n(()=>[a(we,{modelValue:_.value,"onUpdate:modelValue":[e[13]||(e[13]=i=>_.value=i),e[14]||(e[14]=i=>M.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"])])]),_:1}),a(De,{class:"d-flex flex-column align-end pt-2",style:{gap:"8px"}},{default:n(()=>[a(te,{style:{"background-color":"#1677ff",color:"white","font-weight":"500","font-size":"14px",width:"100%","text-transform":"none"},onClick:ne},{default:n(()=>e[23]||(e[23]=[b(" Aplicar ")])),_:1}),a(te,{variant:"text",style:{width:"100%",color:"#555","font-weight":"500","font-size":"13px","text-transform":"none"},onClick:ae},{default:n(()=>e[24]||(e[24]=[b(" Limpiar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},$t={key:0},St={__name:"index",setup(O){const F=he(),$=p([]),{mdAndDown:z}=$e(),y=p(""),s=p({}),B=me(),m=p(!1),_=p(!1),j=p(!1),M=p(!1);function L(f){var k,R;return(R=(k=B.user)==null?void 0:k.permissions)==null?void 0:R.includes(f)}Ge(async()=>{var V,T,D,J,H;const f=(T=(V=B.user)==null?void 0:V.roles)==null?void 0:T.includes("superadmin"),k=(J=(D=B.user)==null?void 0:D.roles)==null?void 0:J.includes("admin"),R=L("businessUnitGroup.viewAny"),A=L("businessUnit.viewAny");if(f||k||R&&A){m.value=!0,_.value=L("businessUnitGroup.create"),j.value=L("businessUnitGroup.update");try{M.value=!0,await K()}catch(se){console.error("Error fetching business unit groups:",se)}finally{M.value=!1}}else m.value=!1,L("businessUnitGroup.view")&&((H=B.user)!=null&&H.business_unit_group_id)&&F.replace(`/grupos-de-ubicaciones/${B.user.business_unit_group_id}`)});const K=async(f={})=>{try{const{data:k}=await ie.get("/business-unit-groups",{params:f});$.value=k.data}catch(k){console.error("Error fetching business unit groups:",k)}finally{M.value=!1}},U=()=>{F.push("/grupos-de-ubicaciones/crear")};function q(){const f={};y.value&&(f.search=y.value),s.value.organizationId&&(f.organization_id=s.value.organizationId),s.value.businessId&&(f.business_id=s.value.businessId),s.value.status&&(f.status=s.value.status),s.value.createdAtStart&&(f.created_at_start=s.value.createdAtStart),s.value.createdAtEnd&&(f.created_at_end=s.value.createdAtEnd),K(f)}function E(f){y.value=f,q()}function C(f){s.value=f,q()}return(f,k)=>m.value?(l(),d("div",$t,[a(Fe,{fluid:""},{default:n(()=>[a(xe,{class:"align-center justify-space-between mb-4"},{default:n(()=>[a(de,{cols:"auto",class:"d-flex align-center"},{default:n(()=>k[0]||(k[0]=[u("h3",{class:"font-weight-medium mb-0"},"Grupo de Ubicaciones",-1)])),_:1}),_.value?(l(),h(de,{key:0,cols:"auto",class:"d-flex align-center justify-end"},{default:n(()=>[a(te,{color:"primary",class:"text-white",elevation:"1",onClick:U},{default:n(()=>[P(z)?(l(),d(ee,{key:0},[a(I,{icon:P(Ce),start:""},null,8,["icon"]),k[1]||(k[1]=u("span",null,"Agregar",-1))],64)):(l(),d(ee,{key:1},[a(I,{icon:P(Ce),start:""},null,8,["icon"]),k[2]||(k[2]=u("span",null,"Agregar Grupo de UbicaciÃ³n",-1))],64))]),_:1})]),_:1})):x("",!0)]),_:1}),a(zt,{onSearch:E,onFilter:C,class:"mb-4"}),a(xe,null,{default:n(()=>[a(de,null,{default:n(()=>[a(yt,{items:$.value,isMobile:P(z),"can-edit-permission":j.value,isLoading:M.value},null,8,["items","isMobile","can-edit-permission","isLoading"])]),_:1})]),_:1})]),_:1})])):x("",!0)}};export{St as default};
