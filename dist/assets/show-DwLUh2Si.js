import{_ as ie,ar as re,J as O,A as de,B as p,an as ue,aC as ce,am as me,c as f,s as d,w as t,a,b as h,l as g,f as R,aj as z,C as x,t as c,Q as S,G as U,p as j,m as F,e as m,x as W,u as b,V,d as l,a9 as A,ao as q,q as pe,v as C,a6 as fe,aB as ve,Z as be,o as n,k as H}from"./index-BtdFDd_C.js";import{j as ge,k as J,f as ye,e as _e}from"./mdi-CCqP_oQm.js";import{p as B}from"./permissionTranslations-DjkJmpfr.js";const he={key:1,class:"font-weight-medium ml-3 mb-0 d-none d-md-block"},xe={key:2,class:"font-weight-medium ml-3 mb-0 d-block d-md-none"},we={key:0},ke={class:"model-cell"},ze={class:"permissions-cell"},Ve={key:0},Ne={class:"d-md-none"},Ce={class:"font-weight-bold mb-2"},Pe={key:1},Re={__name:"show",setup(Ae){const Q={superadmin:"Super Administrador",admin:"Administrador",sponsor:"Sponsor"},Z=["superadmin","admin","sponsor"],E=be(),K=ce(),{mdAndDown:X}=re(),o=O(null),y=O({}),Y=de(),I=p(()=>Y.user||{roles:[],permissions:[]}),ee=p(()=>I.value.roles||[]),P=p(()=>I.value.permissions||[]),L=p(()=>P.value.includes("role.view")),te=p(()=>P.value.includes("role.viewAny")),se=p(()=>P.value.includes("role.update")),oe=p(()=>ee.value.includes("superadmin")),ae=p(()=>{var s,e;return Z.includes((e=(s=o.value)==null?void 0:s.name)==null?void 0:e.toLowerCase())}),T=()=>{var s;(s=o.value)!=null&&s.id&&E.push({path:`/roles/${o.value.id}/edit`})},le=()=>{E.push("/roles")},D={user:"Usuario",role:"Rol",permission:"Permiso",businessUnit:"Ubicación",businessUnitGroup:"Grupo de Ubicaciones",organization:"Organización",business:"Negocio",form:"Formulario",person:"Persona"};function ne(s){const e={},_=(s==null?void 0:s.permissions)||[],i=(s==null?void 0:s.roles)||[];let r=[..._];return i.forEach(u=>{u.permissions&&(r=r.concat(u.permissions))}),r.forEach(u=>{var w,k,M;if((w=u.name)!=null&&w.startsWith("form_field.")||(k=u.name)!=null&&k.startsWith("permission."))return;let v=((M=u.name)==null?void 0:M.split(".")[0])||u.model||u.model_name||"Otro";v==="form_response"&&(v="form"),e[v]||(e[v]=[]),e[v].push(u)}),e}const N=p(()=>Object.keys(y.value).filter(s=>y.value[s]&&y.value[s].length>0));function $(s){return Q[s]||s}function G(s){var _;if(B[s])return B[s];const e=(_=s==null?void 0:s.split("."))==null?void 0:_[1];return B[e]||e||s}return ue(async()=>{if(L.value)try{const s=K.params.id,e=await me.get(`/roles/${s}?with=permissions,roles.permissions`);o.value=e.data||e.data.role||e.data.data,y.value=ne(o.value)}catch(s){console.error("Error al obtener el rol:",s)}}),(s,e)=>{const _=pe("router-link");return L.value?(n(),f(fe,{key:0,fluid:""},{default:t(()=>[a(V,{class:"align-center mb-6","no-gutters":""},{default:t(()=>[a(h,{cols:"auto",class:"d-flex align-center"},{default:t(()=>[te.value?(n(),f(R,{key:0,icon:"",variant:"text",class:"px-3 py-2",style:{"border-radius":"8px",border:"1px solid #ccc","min-width":"44px",height:"44px"},onClick:le},{default:t(()=>[a(z,{icon:x(ge)},null,8,["icon"])]),_:1})):g("",!0),o.value?(n(),d("h3",he,c(o.value.id?`${o.value.id}`:"")+" "+c(o.value.name?`- ${$(o.value.name)}`:"- Rol"),1)):g("",!0),o.value?(n(),d("h3",xe,c(o.value.id?`${o.value.id}`:""),1)):g("",!0)]),_:1}),a(h,{class:"d-flex justify-end align-center"},{default:t(()=>[se.value&&!ae.value?(n(),d(b,{key:0},[x(X)?(n(),f(S,{key:1,location:"bottom end"},{activator:t(({props:i})=>[a(R,W(i,{icon:"",variant:"text",class:"pa-0","min-width":"0",height:"44",style:{"border-radius":"8px",border:"1px solid #ccc","min-width":"44px"}}),{default:t(()=>[a(z,{icon:x(_e),size:"24"},null,8,["icon"])]),_:2},1040)]),default:t(()=>[a(U,{class:"custom-dropdown elevation-1 rounded-lg",style:{"min-width":"180px"}},{default:t(()=>[a(j,{onClick:T},{prepend:t(()=>[a(z,{icon:x(J),size:"16"},null,8,["icon"])]),default:t(()=>[a(F,null,{default:t(()=>e[2]||(e[2]=[m("Editar")])),_:1})]),_:1})]),_:1})]),_:1})):(n(),f(S,{key:0,location:"bottom end"},{activator:t(({props:i})=>[a(R,W(i,{variant:"text",class:"px-3 py-2",style:{"border-radius":"8px",border:"1px solid #ccc","min-width":"44px",height:"44px"}}),{default:t(()=>[e[0]||(e[0]=m(" Opciones ")),a(z,{icon:x(ye),end:"",size:"18"},null,8,["icon"])]),_:2},1040)]),default:t(()=>[a(U,{class:"custom-dropdown elevation-1 rounded-lg",style:{"min-width":"200px"}},{default:t(()=>[a(j,{onClick:T},{prepend:t(()=>[a(z,{icon:x(J),size:"16"},null,8,["icon"])]),default:t(()=>[a(F,null,{default:t(()=>e[1]||(e[1]=[m("Editar")])),_:1})]),_:1})]),_:1})]),_:1}))],64)):g("",!0)]),_:1})]),_:1}),a(V,null,{default:t(()=>[a(h,{cols:"12",class:"mb-2"},{default:t(()=>e[3]||(e[3]=[l("div",{class:"font-weight-bold text-h6"},"Información General",-1)])),_:1})]),_:1}),a(V,null,{default:t(()=>[a(h,{cols:"12"},{default:t(()=>[a(A,{class:"rounded-lg pa-4 mb-6 elevation-1 info-card-effect"},{default:t(()=>[a(q,{class:"rounded-lg elevation-0",style:{border:"none"}},{default:t(()=>{var i,r,u,v,w,k;return[l("tbody",null,[l("tr",null,[e[4]||(e[4]=l("td",{class:"font-weight-bold text-subtitle-1",style:{width:"40%"}},"ID",-1)),l("td",null,c(((i=o.value)==null?void 0:i.id)??"No disponible"),1)]),l("tr",null,[e[5]||(e[5]=l("td",{class:"font-weight-bold text-subtitle-1"},"Nombre",-1)),l("td",null,c((r=o.value)!=null&&r.name?$(o.value.name):"No disponible"),1)]),oe.value?(n(),d("tr",we,[e[6]||(e[6]=l("td",{class:"font-weight-bold text-subtitle-1"},"Organización",-1)),l("td",null,[((u=o.value)==null?void 0:u.name)==="superadmin"?(n(),d(b,{key:0},[m(" Único ")],64)):((v=o.value)==null?void 0:v.name)==="admin"||((w=o.value)==null?void 0:w.name)==="sponsor"?(n(),d(b,{key:1},[m(" Global ")],64)):(k=o.value)!=null&&k.organization&&(o.value.organization.folio||o.value.organization.legal_name||o.value.organization.name)?(n(),f(_,{key:2,to:`/organizaciones/${o.value.organization.id}`,style:{"text-decoration":"underline",color:"#1976d2 !important"}},{default:t(()=>[m(c(o.value.organization.folio??o.value.organization.id)+" - "+c(o.value.organization.legal_name??o.value.organization.name),1)]),_:1},8,["to"])):(n(),d(b,{key:3},[m(" No disponible ")],64))])])):g("",!0)])]}),_:1})]),_:1})]),_:1})]),_:1}),a(V,null,{default:t(()=>[a(h,{cols:"12",class:"mb-2"},{default:t(()=>e[7]||(e[7]=[l("div",{class:"font-weight-bold text-h6"},"Permisos vinculados",-1)])),_:1})]),_:1}),a(V,null,{default:t(()=>[a(h,{cols:"12"},{default:t(()=>[a(q,{class:"rounded-lg elevation-1 fixed-table d-none d-md-table",style:{width:"100%"}},{default:t(()=>[e[9]||(e[9]=l("thead",null,[l("tr",null,[l("th",{class:"model-header font-weight-bold text-subtitle-1"},"Modelo"),l("th",{class:"permissions-header font-weight-bold text-subtitle-1"},"Permisos")])],-1)),l("tbody",null,[(n(!0),d(b,null,C(N.value,i=>(n(),d("tr",{key:i},[l("td",ke,c(D[i]||i),1),l("td",ze,[(n(!0),d(b,null,C(y.value[i],r=>(n(),f(H,{key:r.id||r.name,class:"ma-1",size:"small",color:"primary","text-color":"white"},{default:t(()=>[m(c(G(r.name)),1)]),_:2},1024))),128))])]))),128)),N.value.length===0?(n(),d("tr",Ve,e[8]||(e[8]=[l("td",{colspan:"2",class:"text-center text-medium-emphasis"},"No hay permisos vinculados.",-1)]))):g("",!0)])]),_:1}),l("div",Ne,[(n(!0),d(b,null,C(N.value,i=>(n(),f(A,{key:i,class:"mb-4 pa-3 elevation-1 rounded-lg"},{default:t(()=>[l("div",Ce,c(D[i]||i),1),l("div",null,[(n(!0),d(b,null,C(y.value[i],r=>(n(),f(H,{key:r.id||r.name,class:"ma-1",size:"small",color:"primary","text-color":"white"},{default:t(()=>[m(c(G(r.name)),1)]),_:2},1024))),128))])]),_:2},1024))),128)),N.value.length===0?(n(),f(A,{key:0,class:"mb-4 pa-4 elevation-1 rounded-lg text-center"},{default:t(()=>e[10]||(e[10]=[l("div",{class:"font-weight-bold mb-2",style:{"font-size":"1.5rem"}},"No hay permisos vinculados",-1)])),_:1})):g("",!0)])]),_:1})]),_:1})]),_:1})):(n(),d("div",Pe,[a(ve,{type:"error",class:"mt-10",variant:"outlined",density:"comfortable"},{default:t(()=>e[11]||(e[11]=[m(" No tienes acceso a este rol. ")])),_:1})]))}}},Le=ie(Re,[["__scopeId","data-v-d0e2a6e8"]]);export{Le as default};
